<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veille IA & Actualit√©s 2026</title>
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Comic Neue', cursive; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .sidebar { position: fixed; left: 0; top: 0; width: 50px; height: 100vh; background: linear-gradient(180deg, #ff6b6b, #feca57); border-right: 4px solid #000; z-index: 1000; display: flex; flex-direction: column; justify-content: flex-start; padding-top: 20px; }
        .nav-btn { width: 40px; height: 60px; margin: 5px 5px; background: #fff; border: 3px solid #000; border-radius: 8px; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; transition: all 0.2s ease; box-shadow: 3px 3px 0px #000; }
        .nav-btn:hover { transform: translateY(-2px); box-shadow: 5px 5px 0px #000; }
        .nav-btn.active { background: #f39c12; color: white; }
        .nav-btn .icon { font-size: 16px; margin-bottom: 2px; }
        .refresh-btn { width: 40px; height: 40px; margin: 15px 5px 5px 5px; background: #3498db; border: 3px solid #000; border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; font-size: 18px; transition: all 0.2s ease; box-shadow: 3px 3px 0px #000; color: white; }
        .refresh-btn:hover { transform: translateY(-2px); box-shadow: 5px 5px 0px #000; background: #2980b9; }
        .refresh-btn.loading { animation: spin 1s linear infinite; }
        @keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        .main-content { margin-left: 60px; padding: 20px; min-height: 100vh; }
        .veille-section { display: none; }
        .loading-message { text-align: center; color: #fff; font-size: 1.5em; margin-top: 50px; padding: 20px; background: rgba(0,0,0,0.3); border-radius: 15px; border: 4px solid #000; }
        .error-message { text-align: center; color: #fff; font-size: 1.2em; margin: 50px auto; padding: 20px; background: rgba(231, 76, 60, 0.9); border-radius: 15px; border: 4px solid #000; max-width: 600px; }
        h1 { text-align: center; color: #fff; font-size: 2.5em; margin-bottom: 30px; text-shadow: 3px 3px 0px #000; background: rgba(0,0,0,0.3); padding: 15px; border-radius: 15px; border: 4px solid #000; }
        .edition { text-align: center; color: #fff; font-size: 1.2em; margin-top: -20px; margin-bottom: 20px; text-shadow: 2px 2px 0px #000; }
        .introduction { background: rgba(255,255,255,0.95); padding: 20px; border: 4px solid #000; border-radius: 15px; box-shadow: 8px 8px 0px #000; margin-bottom: 30px; line-height: 1.6; color: #2c3e50; }
        .important-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-bottom: 40px; }
        .card { background: #fff; border: 4px solid #000; border-radius: 15px; padding: 20px; box-shadow: 8px 8px 0px #000; transition: transform 0.2s ease; }
        .card:hover { transform: translateY(-3px); box-shadow: 10px 10px 0px #000; }
        .card-icon { font-size: 2em; text-align: center; margin-bottom: 10px; }
        .card-title { font-size: 1.2em; font-weight: bold; margin-bottom: 15px; color: #2c3e50; line-height: 1.3; }
        .resume-court, .resume-complet { color: #555; line-height: 1.5; margin-bottom: 15px; cursor: pointer; }
        .resume-court:hover { color: #3498db; }
        .resume-complet { display: none; }
        .btn-lire { background: #e74c3c; color: white; border: 3px solid #000; padding: 8px 15px; border-radius: 8px; cursor: pointer; font-family: inherit; font-weight: bold; box-shadow: 3px 3px 0px #000; transition: all 0.2s ease; }
        .btn-lire:hover { background: #c0392b; transform: translateY(-1px); box-shadow: 4px 4px 0px #000; }
        .secondary-section { margin: 40px 0; background: rgba(255,255,255,0.9); padding: 25px; border: 4px solid #000; border-radius: 15px; box-shadow: 8px 8px 0px #000; }
        .secondary-section h2 { color: #2c3e50; font-size: 1.8em; margin-bottom: 20px; text-align: center; text-transform: uppercase; }
        .secondary-item { margin-bottom: 20px; padding: 15px; background: #ecf0f1; border: 2px solid #000; border-radius: 10px; }
        .secondary-title { font-weight: bold; color: #2c3e50; cursor: pointer; margin-bottom: 8px; }
        .secondary-title:hover { color: #3498db; }
        .secondary-description { color: #555; line-height: 1.4; }
        .points-section { background: rgba(52, 152, 219, 0.9); color: white; padding: 25px; border: 4px solid #000; border-radius: 15px; box-shadow: 8px 8px 0px #000; margin-top: 30px; }
        .points-section h2 { font-size: 1.8em; margin-bottom: 20px; text-align: center; text-transform: uppercase; }
        .points-section ul { list-style: none; padding: 0; }
        .points-section li { margin-bottom: 10px; padding-left: 30px; position: relative; }
        .points-section li:before { content: "‚ö°"; position: absolute; left: 0; font-size: 1.2em; }
        .modal { display: none; position: fixed; z-index: 2000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.7); align-items: center; justify-content: center; }
        .modal-content { background: #fff; margin: auto; padding: 30px; border: 4px solid #000; border-radius: 15px; width: 90%; max-width: 800px; max-height: 90vh; overflow-y: auto; position: relative; box-shadow: 10px 10px 0px #000; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; position: absolute; right: 20px; top: 20px; cursor: pointer; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; background: #e74c3c; color: white; border-radius: 50%; border: 2px solid #000; }
        .close:hover { background: #c0392b; }
        .modal h3 { color: #2c3e50; margin-bottom: 15px; font-size: 1.5em; }
        .modal h4 { color: #e74c3c; margin: 20px 0 10px 0; font-size: 1.2em; }
        .modal p, .modal ul, .modal li { margin-bottom: 15px; line-height: 1.6; }
        .modal a { color: #3498db; text-decoration: underline; }
        .modal-source { background: #ecf0f1; padding: 10px; border-left: 4px solid #3498db; margin-bottom: 15px; }
        .modal-source strong { color: #2c3e50; }
        @media (max-width: 768px) { .important-grid { grid-template-columns: 1fr; } .main-content { margin-left: 60px; padding: 10px; } .card { padding: 15px; } }
    </style>
</head>
<body>
    <div class="sidebar">
        <div class="nav-btn active" data-tab="ia" onclick="showTab('ia')"><div class="icon">ü§ñ</div><div>IA</div></div>
        <div class="nav-btn" data-tab="news" onclick="showTab('news')"><div class="icon">üì∞</div><div>News</div></div>
        <div class="refresh-btn" onclick="refreshData()" title="Rafra√Æchir les donn√©es">üîÑ</div>
    </div>
    <div class="main-content">
        <div class="loading-message" id="loading">‚è≥ Chargement des donn√©es de veille...</div>
        <div class="error-message" id="error" style="display: none;">‚ùå Erreur lors du chargement des donn√©es.<br><small id="error-detail"></small></div>
        <div id="veille-container"></div>
    </div>
    <script>
        let donnees = null;
        let modalsContainer = document.createElement('div');
        document.body.appendChild(modalsContainer);
        document.addEventListener('DOMContentLoaded', function() { chargerDonnees(); });
        async function chargerDonnees() {
            try {
                document.getElementById('loading').style.display = 'block';
                document.getElementById('error').style.display = 'none';
                const response = await fetch('data.json?t=' + new Date().getTime());
                if (!response.ok) throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                donnees = await response.json();
                console.log('‚úÖ Donn√©es charg√©es:', donnees);
                genererSections();
                document.getElementById('loading').style.display = 'none';
                const firstSection = document.querySelector('.veille-section');
                if (firstSection) firstSection.style.display = 'block';
            } catch (error) {
                console.error('‚ùå Erreur chargement:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
                document.getElementById('error-detail').textContent = error.message;
            }
        }
        async function refreshData() {
            const btn = document.querySelector('.refresh-btn');
            btn.classList.add('loading');
            await chargerDonnees();
            btn.classList.remove('loading');
        }
        function genererSections() {
            const container = document.getElementById('veille-container');
            container.innerHTML = '';
            modalsContainer.innerHTML = '';
            for (const [cle, veille] of Object.entries(donnees.veilles)) {
                container.innerHTML += genererSectionHtml(cle, veille);
                genererModals(cle, veille);
            }
        }
        function genererSectionHtml(cle, veille) {
            const titre = veille.titre || 'Veille';
            const edition = veille.edition || '';
            const intro = veille.introduction || '';
            let html = `<div id="veille-${cle}" class="veille-section"><h1>${titre}</h1>${edition ? `<div class="edition">${edition}</div>` : ''}${intro ? `<div class="introduction">${intro}</div>` : ''}<div class="important-grid">`;
            veille.sujets_importants.forEach((sujet, index) => {
                const cardId = `card-${cle}-${index}`;
                const modalId = `${cle}-${index}`;
                html += `<div class="card" id="${cardId}"><div class="card-icon">${sujet.icone || 'üìÑ'}</div><div class="card-title">${sujet.titre}</div><div class="resume-court" onclick="toggleResume('${cardId}')">${sujet.resume_court}</div><div class="resume-complet" onclick="toggleResume('${cardId}')">${sujet.resume_complet}</div><button class="btn-lire" onclick="openModal('${modalId}')">Lire +</button></div>`;
            });
            html += `</div>${veille.sujets_secondaires.length > 0 ? `<div class="secondary-section"><h2>Autres sujets de la semaine</h2>` : ''}`;
            veille.sujets_secondaires.forEach((sujet, index) => {
                const modalId = `${cle}-sec-${index}`;
                html += `<div class="secondary-item"><div class="secondary-title" onclick="openModal('${modalId}')">${sujet.titre}</div><div class="secondary-description">${sujet.resume}</div></div>`;
            });
            html += `${veille.sujets_secondaires.length > 0 ? '</div>' : ''}${veille.points_cles.length > 0 ? `<div class="points-section"><h2>Points Cl√©s √† Retenir</h2><ul>${veille.points_cles.map(point => `<li>${point}</li>`).join('')}</ul></div>` : ''}</div>`;
            return html;
        }
        function genererModals(cle, veille) {
            veille.sujets_importants.forEach((sujet, index) => { modalsContainer.innerHTML += genererModalHtml(`${cle}-${index}`, sujet); });
            veille.sujets_secondaires.forEach((sujet, index) => { modalsContainer.innerHTML += genererModalHtml(`${cle}-sec-${index}`, sujet); });
        }
        function genererModalHtml(modalId, sujet) {
            let html = `<div id="modal-${modalId}" class="modal"><div class="modal-content"><span class="close" onclick="closeModal('${modalId}')">&times;</span><h3>${sujet.titre}</h3><h4>R√©sum√©</h4><p>${sujet.resume || sujet.resume_complet}</p>`;
            if (sujet.points_de_vue && sujet.points_de_vue.length > 0) {
                html += `<h4>Points de vue crois√©s</h4>`;
                sujet.points_de_vue.forEach(pv => { html += `<div class="modal-source"><strong>${pv.nom}</strong><br>${pv.texte}</div>`; });
            }
            if (sujet.fiabilite && sujet.fiabilite.length > 0) {
                html += `<h4>Fiabilit√© & signaux faibles</h4><ul>${sujet.fiabilite.map(item => `<li>${item}</li>`).join('')}</ul>`;
            }
            if (sujet.sources && sujet.sources.length > 0) {
                html += `<h4>Sources</h4><ul>${sujet.sources.map(s => `<li><a href="${s.url}" target="_blank" rel="noopener">${s.titre}</a></li>`).join('')}</ul>`;
            }
            html += `</div></div>`;
            return html;
        }
        function showTab(tabName) {
            document.querySelectorAll('.veille-section').forEach(s => s.style.display = 'none');
            const section = document.getElementById('veille-' + tabName);
            if (section) section.style.display = 'block';
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            const activeBtn = document.querySelector('.nav-btn[data-tab="' + tabName + '"]');
            if (activeBtn) activeBtn.classList.add('active');
        }
        function toggleResume(cardId) {
            const card = document.getElementById(cardId);
            if (!card) return;
            const court = card.querySelector('.resume-court');
            const complet = card.querySelector('.resume-complet');
            if (!court || !complet) return;
            if (complet.style.display === 'none' || !complet.style.display) {
                court.style.display = 'none';
                complet.style.display = 'block';
            } else {
                court.style.display = 'block';
                complet.style.display = 'none';
            }
        }
        function openModal(modalId) {
            const modal = document.getElementById('modal-' + modalId);
            if (modal) modal.style.display = 'flex';
        }
        function closeModal(modalId) {
            const modal = document.getElementById('modal-' + modalId);
            if (modal) modal.style.display = 'none';
        }
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) event.target.style.display = 'none';
        };
    </script>
</body>
</html>