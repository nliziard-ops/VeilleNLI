name: ğŸ” Validation Markdown

on:
  workflow_dispatch:
  # DÃ©clenchÃ© aprÃ¨s les workflows de veille
  workflow_run:
    workflows: ["ğŸ¤– Veille IA OpenAI", "ğŸ“° Veille ActualitÃ©s OpenAI"]
    types:
      - completed

env:
  TZ: Europe/Paris

jobs:
  validation:
    name: Validation structure Markdown
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'success' || github.event_name == 'workflow_dispatch' }}
    
    steps:
      - name: ğŸ“¥ Checkout repository
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
      
      - name: ğŸ Setup Python 3.11
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          cache: 'pip'
      
      - name: ğŸ“¦ Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install google-api-python-client google-auth
      
      - name: âœ… Validate Markdown files
        env:
          GOOGLE_DRIVE_CREDENTIALS: ${{ secrets.GOOGLE_DRIVE_CREDENTIALS }}
          GOOGLE_DRIVE_FOLDER_ID: ${{ secrets.GOOGLE_DRIVE_FOLDER_ID }}
        run: |
          echo "ğŸ” Lancement validation Markdown..."
          python agents/agent_validateur_markdown.py
      
      - name: ğŸ“Š Summary
        if: always()
        run: |
          echo "âœ… Validation Markdown terminÃ©e"
          echo "ğŸ“„ VeilleIA.md et VeilleNews.md vÃ©rifiÃ©s"
          echo "ğŸ”§ Structure garantie : 6 sujets principaux minimum"
